<html>
<head>
	<style>
	.board-overlay {
		border-radius: 10pt;
		background: #aaa;
		padding: 10pt;
		border: 1px solid black;
		display:inline-block;
	}
	.board {
		background: #eee;
		border-collapse: collapse;
	}
	.tasks {
	    height: 200pt;
	}
	.tasks td {
		width:70pt;
		text-align: center;
		border: 1px solid black;
		vertical-align: top;
	}
	.task {
		    background: yellow;
		    border-radius: 6pt;
		    padding: 3pt;
		    margin: 3pt;
		    border-style: solid;
		    border-color: black;
		    border-width: thin;
			text-align: center;
		}
	.board th {
		text-align: center;
		border: 1px solid black;
		background-color: eea;
	}
	
	
	</style>
	<script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
	<script>
	$.fn.animateAppendTo = function(sel, speed) {
		if (speed < 10) {
			this.detach();
			this.appendTo(sel);
			return this;
		}
	    var $this = this,
	        newEle = $this.clone(true).appendTo(sel),
	        newPos = newEle.position();
	    newEle.hide();
		thisPosition = this.position();
		this.width(this.width());
	    $this.css('position', 'absolute').css(thisPosition).animate(newPos, speed, function() {
	        newEle.show();
	        $this.remove();
	    });
	    return newEle;
	};
	</script>
</head>
<body>
	<div class="board-overlay">
		Day: <span id="day"></span>, time: <span id="hour"></span>
	<table class="board">
		<tr>
			<th rowspan="2">Backlog</th>
			<th colspan="2">Analysis</th>
			<th colspan="2">Development</th>
			<th colspan="2">QA</th>
			<th colspan="2">Deployment</th>
		</tr>
		<tr>
			<th>Doing</th>
			<th>Done</th>
			<th>Doing</th>
			<th>Done</th>
			<th>Doing</th>
			<th>Done</th>
			<th>Doing</th>
			<th>Done</th>
		</tr>
		<tr class="tasks">
			<td id="input"></td>
			<td id="analysis"></td>
			<td id="analysed"></td>
			<td id="development"></td>
			<td id="developed"></td>
			<td id="qa"></td>
			<td id="tested"></td>
			<td id="deployment"></td>
			<td id="done"></td>
		</tr>
	</table>
	</div>
	
	<script>
	var hourLengthInSeconds = 0.1;
	var hour=0;
	var taskCounter = 1;
	updateTime(hour);
	
	setTimeout( "hourPassed()", hourLengthInSeconds * 1000 );
	
	function hourPassed() {		
		updateTime(++hour);
		resetColumnsCapacity();
		addNewTasks();
		moveTasks();
		setTimeout( "hourPassed()", hourLengthInSeconds * 1000 );
	}
	
	function updateTime(hour) {
		$("#day").text(Math.floor(hour / 8) + 1);
		$("#hour").text((hour % 8 + 9) +":00");
	}
	
	function addNewTasks() {
		if (Math.random() < 0.4) {
			var newTask = $("<div class='task'>Task " + (taskCounter++) +"</div>");
			newTask.data("created", hour);
			newTask.data("analysis", 4);
			newTask.data("development", 7);
			newTask.data("qa", 5);
			newTask.data("deployment", 1);
			$('#input').append(newTask);
		}
	}
	
	function moveTasks() {
		$($('.task').get()).each(function() {
			workOn(this);
			if (finished(this)) {
				var nextColumn = findNextColumn(this);
				if (!nextColumn) $(this).remove();
				else $(this).animateAppendTo(nextColumn,  hourLengthInSeconds * 100);
			}
		});
	}
	
	function findNextColumn(task) {
		var column = $(task).parent();
		var workType = column.attr('id');
		while (finished(task, column) && column){
			if (finished(task, column)) {
				column = column.next();
			}
		}
		return column;
	}
	
	function finished(task, column) {
		if (!column) {
			column = $(task).parent();
		}
		var workType = column.attr('id');
		return $(task).data(workType) == 0 || !$(task).data(workType);
	}
	
	function workOn(task) {
		var workType = $(task).parent().attr('id');
		var headsAvailable = $(task).parent().data("heads");
		if ($(task).data(workType) > 0 && headsAvailable > 0) {
			$(task).parent().data("heads", headsAvailable - 1);
			$(task).data(workType, $(task).data(workType) - 1);
		}
	}
	
	function resetColumnsCapacity() {
		$("#analysis").data("heads", 2);
		$("#development").data("heads", 3);
		$("#qa").data("heads", 2);
		$("#deployment").data("heads", 1);
	}
	
	function setColumnsConstraints() {
		
	}
	</script>
</body>
</html>